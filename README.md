# Туристическое агентство - Веб-приложение

Проект состоит из двух частей:
- Серверная часть (Node.js, Express, SQLite)
- Клиентская часть (React)

## Запуск проекта обычным способом

### Запуск сервера:

```bash
cd server
npm install
npm start
```

Сервер будет доступен по адресу: http://localhost:5001

### Запуск клиента:

```bash
cd client
npm install
npm start
```

Клиентская часть будет доступна по адресу: http://localhost:3000

## Запуск проекта с использованием Docker

### Запуск всего приложения через Docker Compose:

```bash
docker-compose up -d
```

После запуска:
- Клиентская часть будет доступна по адресу: http://localhost
- Серверная часть будет доступна по адресу: http://localhost:5001

### Запуск только сервера через Docker:

```bash
cd server
docker build -t travel-agency-server .
docker run -p 5001:5001 -d travel-agency-server
```

### Запуск только клиента через Docker:

```bash
cd client
docker build -t travel-agency-client .
docker run -p 80:80 -d travel-agency-client
```

## Запуск интеграционных тестов сервера

```bash
cd server
npm test
```

## Остановка Docker контейнеров

```bash
docker-compose down
```

## Описание проекта
Полнофункциональное веб-приложение для туристического агентства, разработанное с использованием стека MERN (SQLite вместо MongoDB). Проект реализует систему просмотра туров, бронирования, управления отзывами и администрирования всего контента.

### Ключевые возможности:
- Просмотр каталога туров с подробным описанием
- Система бронирования туров с выбором даты и количества участников
- Отзывы пользователей о турах с рейтингом
- Панель администратора для управления турами, бронированиями и отзывами
- Аутентификация и авторизация пользователей с разными уровнями доступа

## Технический стек

### Бэкенд:
- **Node.js** и **Express** - серверная часть приложения
- **SQLite** - база данных для хранения информации
- **JWT** (JSON Web Tokens) - для аутентификации
- **bcrypt** - для хеширования паролей

### Фронтенд:
- **React** - библиотека для построения пользовательского интерфейса
- **React Router** - для маршрутизации на клиенте
- **Axios** - для HTTP запросов к API
- **CSS** - для стилизации компонентов

## Структура проекта

```
travel-agency/
├── client/                  # Фронтенд на React
│   ├── public/              # Статические файлы
│   └── src/
│       ├── components/      # React компоненты
│       │   ├── admin/       # Компоненты панели администратора
│       │   └── ...          # Другие компоненты 
│       ├── App.js           # Основной компонент приложения
│       └── ...              # Остальные файлы
│
├── server/                  # Бэкенд на Node.js и Express
│   ├── server.js            # Основной файл сервера
│   ├── database.db          # База данных SQLite
│   └── ...                  # Конфигурационные файлы
│
└── README.md                # Документация проекта
```

## Основные функции приложения

### Для пользователей:
- Просмотр списка всех доступных туров
- Подробная информация о конкретном туре (описание, цена, длительность и т.д.)
- Возможность бронирования тура (выбор даты и количества участников)
- Просмотр истории своих бронирований
- Оставление отзывов о турах с оценкой по 5-балльной шкале

### Для администраторов:
- Управление турами (создание, редактирование, удаление)
- Управление бронированиями (просмотр, изменение статуса)
- Модерация отзывов пользователей (просмотр, удаление)

## Инструкция по установке и запуску

### Предварительные требования
- Node.js (версия 14.x или выше)
- npm (версия 6.x или выше)

### Пошаговая инструкция

#### 1. Клонирование репозитория
```bash
git clone <url-репозитория>
cd travel-agency
```

#### 2. Установка зависимостей для сервера
```bash
cd server
npm install
```

#### 3. Установка зависимостей для клиента
```bash
cd ../client
npm install
```

#### 4. Настройка переменных окружения
Создайте файл `.env` в директории `server` со следующим содержимым:
```
PORT=5001
JWT_SECRET=ваш_секретный_ключ_для_jwt
```

#### 5. Запуск сервера
```bash
cd ../server
npm start
```
Сервер запустится на порту 5001.

#### 6. Запуск клиента (в отдельном терминале)
```bash
cd ../client
npm start
```
Клиентская часть будет доступна по адресу [http://localhost:3000](http://localhost:3000)

## Тестовые учетные записи

### Администратор
- **Логин**: admin
- **Пароль**: admin

### Пользователь
- **Логин**: user
- **Пароль**: user

## API-маршруты

### Аутентификация
- `POST /api/auth/login` - вход в систему
- `POST /api/auth/register` - регистрация пользователя

### Туры
- `GET /api/tours` - получить все туры
- `GET /api/tours/:id` - получить информацию о конкретном туре
- `POST /api/admin/tours` - создать новый тур (требуется права администратора)
- `PUT /api/admin/tours/:id` - обновить тур (требуется права администратора)
- `DELETE /api/admin/tours/:id` - удалить тур (требуется права администратора)

### Бронирования
- `POST /api/bookings` - создать новое бронирование
- `GET /api/user/bookings` - получить бронирования пользователя
- `PUT /api/user/bookings/:id/cancel` - отменить бронирование
- `GET /api/admin/bookings` - получить все бронирования (требуется права администратора)
- `PUT /api/admin/bookings/:id` - обновить статус бронирования (требуется права администратора)

### Отзывы
- `GET /api/tours/:id/reviews` - получить отзывы для конкретного тура
- `POST /api/tours/:id/reviews` - добавить отзыв о туре
- `GET /api/admin/reviews` - получить все отзывы (требуется права администратора)
- `DELETE /api/reviews/:id` - удалить отзыв (требуется права администратора)

## Возможные проблемы и их решения

### Сервер не запускается
- Убедитесь, что порт 5001 свободен или измените порт в файле `.env`
- Проверьте наличие всех необходимых зависимостей

### Проблемы с базой данных
- База данных инициализируется автоматически при первом запуске сервера
- Если возникают ошибки, удалите файл `database.db` и перезапустите сервер

### Ошибки при аутентификации
- Проверьте правильность JWT_SECRET в файле `.env`
- Убедитесь, что токен передается в заголовке Authorization

## Разработка и внесение изменений

### Добавление новых функций
1. Создайте новую ветку из main: `git checkout -b feature/новая-функция`
2. Внесите необходимые изменения
3. Протестируйте изменения
4. Создайте pull request для слияния с веткой main

### Стиль кода
- Используйте ESLint для поддержания единообразия кода
- Следуйте принципам компонентного подхода React
- Документируйте новые функции и API-маршруты

## Лицензия
MIT License 